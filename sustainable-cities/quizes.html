<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Sustainable Cities Quiz</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
        }

        #quiz-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: white;
            padding: 20px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            display: none;
            z-index: 10;
            border-radius: 10px;
        }

        #quiz-popup button {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            cursor: pointer;
            margin-top: 10px;
        }

        #quiz-popup button:hover {
            background-color: #45a049;
        }

        .dull {
            opacity: 0.5;
        }

        #svg-container {
            margin-top: 50px;
            text-align: center;
        }

        .sustainable-element {
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .sustainable-element:hover {
            transform: scale(1.1);
        }

        #quiz-popup h3 {
            font-size: 1.2rem;
            font-weight: bold;
        }
    </style>
</head>
<body>

<h1 style="text-align: center; padding: 20px; background-color: #4CAF50; color: white;">Sustainable Cities Quiz</h1>

<div id="svg-container">
    <!-- The SVG will be generated by D3.js -->
</div>

<div id="quiz-popup">
    <h3 id="question">What is the main purpose of solar panels in sustainable cities?</h3>
    <ul id="options">
        <li><button class="answer">Produce electricity</button></li>
        <li><button class="answer">Decorate buildings</button></li>
        <li><button class="answer">Provide shade</button></li>
        <li><button class="answer">Cool the environment</button></li>
    </ul>
    <button id="close-btn">Close</button>
</div>

<script src="https://d3js.org/d3.v7.min.js"></script>
<script>
    const sustainableData = [
        {
            name: "Solar Panel",
            x: 200,
            y: 150,
            color: "yellow",
            question: "What is the main purpose of solar panels in sustainable cities?",
            correctAnswer: "Produce electricity"
        },
        {
            name: "Wind Turbine",
            x: 400,
            y: 150,
            color: "lightblue",
            question: "What do wind turbines primarily generate?",
            correctAnswer: "Wind energy"
        },
        {
            name: "Recycled Water System",
            x: 600,
            y: 150,
            color: "lightgreen",
            question: "Why are recycled water systems important in sustainable cities?",
            correctAnswer: "Reduce water wastage"
        }
    ];

    // SVG container setup using D3.js
    const width = 800;
    const height = 400;

    const svg = d3.select("#svg-container")
        .append("svg")
        .attr("width", width)
        .attr("height", height);

    // Add elements (e.g., Solar Panel, Wind Turbine)
    sustainableData.forEach(function (item) {
        svg.append("circle")
            .attr("cx", item.x)
            .attr("cy", item.y)
            .attr("r", 30)
            .attr("fill", item.color)
            .attr("class", "sustainable-element")
            .attr("data-name", item.name)
            .attr("data-question", item.question)
            .attr("data-correct", item.correctAnswer)
            .on("click", function(event, d) {
                openQuizPopup(item);
            });
    });

    // Handle quiz popup interaction
    function openQuizPopup(item) {
        const questionText = item.question;
        const correctAnswer = item.correctAnswer;

        // Show the popup
        const popup = document.getElementById('quiz-popup');
        popup.style.display = 'block';

        // Update the question
        document.getElementById('question').innerText = questionText;

        // Update the options
        const options = document.getElementById('options');
        options.innerHTML = '';
        const answers = [
            "Produce electricity",
            "Decorate buildings",
            "Provide shade",
            "Cool the environment"
        ];
        answers.forEach(function(answer) {
            const li = document.createElement('li');
            const button = document.createElement('button');
            button.classList.add('answer');
            button.innerText = answer;
            button.onclick = function () {
                checkAnswer(button, correctAnswer, item);
            };
            li.appendChild(button);
            options.appendChild(li);
        });

        // Close button event
        document.getElementById('close-btn').onclick = function() {
            popup.style.display = 'none';
        };
    }

    // Check the selected answer
    function checkAnswer(button, correctAnswer, item) {
        const selectedAnswer = button.innerText;

        const element = d3.select(`[data-name="${item.name}"]`);

        if (selectedAnswer === correctAnswer) {
            element.style("fill", "green"); // Change color to green for correct
        } else {
            element.style("fill", "grey"); // Dull color for incorrect
        }

        // Disable all answers after selection
        const allAnswers = document.querySelectorAll('.answer');
        allAnswers.forEach(function(ans) {
            ans.disabled = true;
        });

        // Optionally, display feedback and close the popup
        setTimeout(function() {
            document.getElementById('quiz-popup').style.display = 'none';
        }, 1000);
    }
</script>

</body>
</html>